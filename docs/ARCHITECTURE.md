# Архитектура платформы

## Обзор

Платформа построена на микросервисной архитектуре с единой точкой входа (API Gateway). Все сервисы контейнеризированы с помощью Docker и оркестрируются через Docker Compose.

## Микросервисы

### 1. Proxy Service (API Gateway)
- **Порт**: 8000
- **Назначение**: Единая точка входа для всех клиентских запросов
- **Функции**:
  - Маршрутизация запросов к соответствующим микросервисам
  - Аутентификация через JWT токены
  - Балансировка нагрузки
  - Обработка ошибок

### 2. Tokens Service
- **Порт**: 8001
- **Назначение**: Управление JWT токенами
- **Функции**:
  - Генерация access и refresh токенов
  - Валидация токенов
  - Управление refresh токенами
  - Сброс паролей

### 3. Notifications Service
- **Порт**: 8002
- **Назначение**: Отправка уведомлений
- **Функции**:
  - Email уведомления (регистрация, сброс пароля)
  - SMS уведомления (планируется)
  - Асинхронная обработка через Celery и RabbitMQ

### 4. Streaming Service
- **Порт**: 8003
- **Назначение**: Обработка и стриминг видео
- **Функции**:
  - Хранение видео в S3 (MinIO)
  - Генерация presigned URLs для стриминга
  - Управление метаданными видео

### 5. Courses Service
- **Порт**: 8004
- **Назначение**: Управление курсами и контентом
- **Функции**:
  - CRUD операции для курсов и уроков
  - Отслеживание прогресса пользователей
  - Система достижений
  - Запись на курсы

### 6. ChatBot Service
- **Порт**: 8005
- **Назначение**: Виртуальный помощник
- **Функции**:
  - Контекстные ответы на основе текущего урока
  - История сообщений
  - Интеграция с курсами для контекста

## База данных

### PostgreSQL
- Единая база данных для всех микросервисов
- Схемы разделены по таблицам (префиксы по сервисам)
- Миграции выполняются независимо для каждого сервиса

### Redis
- Кеширование данных
- Хранение сессий
- Очереди для Celery

## Хранилище файлов

### MinIO (S3-совместимое)
- Хранение видео уроков
- Хранение изображений курсов
- Хранение аватаров пользователей

## Очереди сообщений

### RabbitMQ
- Асинхронная обработка уведомлений
- Задачи Celery для фоновых операций

## Frontend

### React + MobX (MVVM)
- Компонентная архитектура
- Управление состоянием через MobX stores
- Адаптивный дизайн с Material-UI
- Поддержка крупных элементов для удобства

## Аутентификация

### JWT токены
- **Access токен**: короткоживущий (15 минут)
- **Refresh токен**: долгоживущий (7 дней)
- Валидация через Tokens Service
- Автоматическое обновление токенов

## Безопасность

- HTTPS через Nginx (в production)
- CORS настройки
- Валидация входных данных
- Защита от SQL инъекций (ORM Django)
- Защита от XSS (React экранирование)

## Масштабируемость

- Горизонтальное масштабирование микросервисов
- Готовность к миграции на Kubernetes
- Stateless сервисы
- Кеширование для производительности

